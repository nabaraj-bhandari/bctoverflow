generator client {
  provider = "prisma-client"
  output   = "../src/lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Subject {
  code      String     @id
  resources Resource[]
  
  @@index([code])
}

model Resource {
  id          String
  subjectCode String
  title       String
  githubPath  String
  sections    Section[]
  subject     Subject   @relation(fields: [subjectCode], references: [code], onDelete: Cascade)
  
  @@id([subjectCode, id])
  @@index([subjectCode])
}

model Section {
  id          String
  resourceId  String
  subjectCode String
  title       String
  checksum    String
  resource    Resource @relation(fields: [subjectCode, resourceId], references: [subjectCode, id], onDelete: Cascade)
  
  @@id([subjectCode, resourceId, id])
  @@index([subjectCode, resourceId])
}

model MetaData {
  id        Int      @id @default(1)
  checksum  String
  updatedAt DateTime @updatedAt
}
